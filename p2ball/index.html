<!doctype html>
<html>
<head>
    <title>P2 Ball - 物理弹球</title>
    <meta charset="utf-8">
    <script src="../phaser.min.js"></script>
	<style type="text/css">
	body {margin: 0;padding: 0;	}
	canvas {margin: 0 auto;position: relative;left:0;top:0;}
	</style>
</head>
<body>
<script type="text/javascript">

var GameState = function(game){
	var _over = false;
	var _holding = false;
	var _going = false;
	var _pointID = -1;
	var _ballNum = 3;
	var _ballKill = 0;
	var _xrow;
	var _score;
	var _level;

	var balls,shapes,line,tweenText;
	var ballMaterial,worldMaterial;

	this.init = function(){
		game.stage.backgroundColor = "#112233";
		_over = false;
		_holding = false;
		_going = false;
		_pointID = -1;
		_ballNum = 3;
		_ballKill = 0;
		_xrow = 0;
		_score = 0;
		_level = 0;
	};

	this.preload = function(){
		if(!game.device.desktop){
			this.scale.scaleMode = Phaser.ScaleManager.EXACT_FIT;
		}else{
			this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
		}
		this.load.image("ground", "img/ground.png");
		this.load.spritesheet("ball", "img/balls.png",32,32);
		this.load.spritesheet("ball2", "img/balls2.png",48,48);
		this.load.spritesheet("button", "img/buttons.png",80,40);
		this.load.image("dot", "img/dot.png");
	};

	this.create = function(){
		game.physics.startSystem(Phaser.Physics.P2JS); 
		game.physics.p2.gravity.y = 1000;

		ballMaterial = game.physics.p2.createMaterial('ballMaterial');
		worldMaterial = game.physics.p2.createMaterial('worldMaterial');
		game.physics.p2.createContactMaterial(ballMaterial, worldMaterial, { restitution:0.98, friction:0 });
		game.physics.p2.createContactMaterial(ballMaterial, ballMaterial,{ restitution:0, friction:0, stiffness:0.00001 });
		game.physics.p2.setWorldMaterial(worldMaterial);

		game.add.tileSprite(0, 0, game.width, 60, "ground").alpha=0.5;

		var home = game.add.sprite(game.world.centerX, 30, "ball", 3);
		home.anchor.setTo(0.5);
		home.scale.setTo(1.2);
		home.update = function(){this.alpha = (!_over && !_going) ? 1 : 0.5;};

		var scoreText = game.add.text(10, 30, _score + "", {fontSize:"20px", fill:"#fff"});
		scoreText.anchor.setTo(0, 0.5);
		scoreText.update = function(){this.text = _score;};

		var levelText = game.add.text(game.width-10, 30, _ballNum + "", {fontSize:"20px", fill:"#fff"});
		levelText.anchor.setTo(1, 0.5);
		levelText.update = function(){this.text = _ballNum;};

		shapes = game.add.physicsGroup(Phaser.Physics.P2JS);
		balls = game.add.physicsGroup(Phaser.Physics.P2JS);

		// Ground
		var ground = game.add.tileSprite(game.world.centerX, game.height-30, game.width, 60, "ground");
		game.physics.p2.enable(ground);  
		ground.body.static = true;
		ground.body.onBeginContact.add(function(b1,b2){
			if(b1 && b1.sprite.key == "ball"){
				b1.sprite.kill();
				_ballKill++;
				if(_ballKill==_ballNum){
					this._shapesUp();
				}
			}
		},this);

		tweenText = game.add.text(0,0,"",{fontSize:"36px", fill:"#fff"});
		tweenText.anchor.setTo(0.5);
		tweenText.alpha = 0;

		line = game.add.tileSprite(game.world.centerX, 30, game.world.centerX, 16, "dot");
		line.anchor.setTo(0,0.5);
		line.visible = false;

		// Create shapes
		for (var i=2; i<5; i++){
			this._createShapes(i);
		}

		game.input.onDown.add(function(p){
			if(!_over && !_going && !_holding){
				_holding = true;
				_pointID = p.id;
				line.rotation = Math.atan2(p.y - 20, p.x - 225);
				line.visible = true;
			}
		},this);

		game.input.onUp.add(function(p){
			if(_holding && p.id == _pointID){
				_holding = false;
				_pointID = -1;
				_going = true;
				line.visible = false;
				// Create Balls
				var vPoint = this._velocityFromRotation(line.rotation,800);
				for(var i=0; i<_ballNum; i++){
					game.time.events.add(200*i,function(id,p){
						if(id<balls.children.length){
							var ball = balls.getChildAt(id);
							ball.reset(game.world.centerX, 30);
						}else{
							var ball = balls.create(game.world.centerX, 30, "ball", 0);
							ball.anchor.set(0.5);
							ball.scale.set(0.7);
							ball.body.setCircle(12);
							ball.body.setMaterial(ballMaterial);
							ball.body.onBeginContact.add(function(b1,b2){
								if(this.body.data.gravityScale == 0){
									if(b1 && b1.sprite.key == "ball"){
										return;
									}
									this.body.data.gravityScale = 1;
								}
							},ball);
						}
						ball.body.data.gravityScale = 0;
						ball.body.velocity.x = p.x;
						ball.body.velocity.y = p.y;
					},this,i,vPoint);
				}
				_ballKill = 0;
			}
		},this);
	};

	this.update = function(){
		if(!_going && _holding){
			var p = _pointID==0 ? game.input.mousePointer : game.input.pointers[_pointID-1];
			line.rotation = Math.atan2(p.y - 20, p.x - 225);
		}
	};

	this._shapesUp = function(){
		this._createShapes(5);
		shapes.forEachAlive(function(shape){
			var topY = shape.body.y - 90;
			if(topY<60 && !_over){
				_over = true;
				this._overMenu();
			}
			game.add.tween(shape.body).to({y:topY},200,"Linear",true);
		},this);
		_going = false;
	};

	this._createShapes = function(i){
		if(_xrow==0){
			this._levelUp();
		}
		var col = 5 - (_xrow % 2);
		for (var j=0; j<col; j++){
			var shapeID = game.rnd.between(1,3);
			var angle = game.rnd.between(0,11)*30;
			var shape = shapes.getFirstDead(true, 65 + j * 90 + 45 * (_xrow % 2), 300 + i * 90, "ball2", shapeID);
			shape.anchor.set(0.5);
			if(shapeID==1){
				shape.body.setRectangle(44,44,0,0);
			}else if(shapeID==3){
				shape.body.addPolygon(null,[23,0,0,39,1,40,46,40,47,39,24,0]);
			}else{
				shape.body.setCircle(22);
			}
			shape.body.static = true;
			shape.body.setMaterial(worldMaterial);
			shape.health = game.rnd.between(_ballNum, _ballNum * 4); // 生命值为球数量的1~4倍
			if(!shape.txt){
				shape.txt = shape.addChild(game.make.text(0,0,shape.health+"",{fontSize:"20px", fill:"#f00"}));
				shape.txt.anchor.set(0.5);
				shape.update = function(){this.txt.text = this.health;};
				shape.body.onEndContact.add(function(b1,b2){
					this.damage(1);
					_score++;
				},shape);
			}
			shape.body.angle = angle;
			shape.txt.angle = -angle;
		}
		_xrow = (_xrow+1) % 10; // 每10行过关
	};

	this._velocityFromRotation = function (rotation, speed) {
		return new Phaser.Point((Math.cos(rotation) * speed), (Math.sin(rotation) * speed));
	};

	this._levelUp = function(){
		_level ++;
		_ballNum = _level + 2; // 球数量为关数+2（第一关为3球，每过一关+1球）
		tweenText.x = this.world.centerX;
		tweenText.y = this.world.centerY;
		tweenText.alpha = 0;
		tweenText.setText("LEVEL - " + _level);
		game.add.tween(tweenText)
		.to({y:tweenText.y-100,alpha:0.8},300,"Linear",false)
		.to({y:tweenText.y-150},500,"Linear",false)
		.to({y:tweenText.y-250,alpha:0},300,"Linear",true);
	};

	this._overMenu = function(){
		var box = game.add.sprite(game.world.centerX, game.world.centerY, "button", 3);
		box.anchor.set(0.5);
		box.alpha = 0.8;
		box.scale.set(game.width/80,5);

		game.add.text(game.world.centerX, game.world.centerY-40, "Game Over", {fontSize:"36px", fill:"#fff"}).anchor.set(0.5);

		var btn1 = game.add.sprite(game.world.centerX, game.world.centerY+40, "button", 1);
		btn1.anchor.set(0.5);
		btn1.inputEnabled = true;
		btn1.events.onInputDown.add(function(){
			game.state.start("main");
		},this);
	};
};

window.onload = function(){
	var game = new Phaser.Game(500, 860, Phaser.CANVAS, '');
	game.state.add("main",GameState,true);
};

</script>

	<script async src="https://www.googletagmanager.com/gtag/js?id=G-FW4M5RXDKZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FW4M5RXDKZ');
</script>

       <script src=https://mngz47.github.io/monetize/api.js ></script>
       <script src=https://mngz47.github.io/monetize/cookie.js ></script>
       <script src=https://mngz47.github.io/monetize/paypal.js ></script>
       <script src=https://mngz47.github.io/monetize/payfast.js ></script>
       

<h4 onclick="toggle(e('start'));" id=credits style='position:absolute;float:right;margin:4px;background:rgba(0,0,0,0.7);color:white;' ></h4>    
<div id=start style="position: absolute;top:0;background-color:rgba(0,0,0,0.7);width:100%;height:100%;z-index:1000;padding:40px;y-overflow:auto;" >
   <a href=# onclick="toggle(e('start'));" ><h6 style="color:white;" id=buy_credits >Buy Credits:</h6></a>
   <div style='margin-top:10px;color:white;' >
	   <label>Credit Card<input type=checkbox id=credit_card  /></label>
	   <label>PayPal<input type=checkbox id=paypal_option  /></label>
	   <br><br>
	   <input type=number id=credits value=40 placeholder=credits />
	   <button onclick='monetize_purchase(e("credits").value);return false;' >buy</button>
   </div>
	
	<script src="https://mngz47.github.io/monetize/search.js" ></script>
	 <div style='float:right;margin-top:10px;' ><input type=text id=search_game placeholder=games /><button onclick='search(e("search_game").value);return false;' >search</button></div>
          <div id=search_results style="position:absolute;float:right;" ></div>

   <div id=menu style="overflow-x:auto;overflow:hidden;height:200px;width:100%;"></div>

	<div class=row >
		<div class=col-sm-6 ><div id=menu-text style="color:white;padding:40px;"></div></div>
		<div class=col-sm-6 >
			<div id='amazon_products' style='display:none' >


		<span class=title >Nepal vs. ZA | clouded judge until I ran out of time</span>
		<p>-<a href="https://www.youtube.com/watch?v=NK3DWlgCv14" >Video</a></p>
	
		<span class=title >Stuck on stage 3 formulating movement | classic flower snake</span>
		<p>-<a href="https://www.youtube.com/watch?v=7QKCJW8hCbQ" >Video</a></p>
	
		<span class=title >Won the houses price in the first 46 seconds | Pamel Slots</span>
		<p>-<a href="https://www.youtube.com/watch?v=EU_P_WEsYug" >Video</a></p>
	
		<span class=title >Japan vs. ZA on chess.com | won last 57 seconds</span>
		<p>-<a href="https://www.youtube.com/watch?v=pw2rfk4BUOo" >Video</a></p>
	
		<span class=title >Ended up on stage 7 on the 29th minute | Classic Flower Snake</span>
		<p>-<a href="https://www.youtube.com/watch?v=pZROcOdfnBg" >Video</a></p>
	
		<span class=title >Turkey vs. ZA on chess.com | resigned after a good fight</span>
		<p>-<a href="https://www.youtube.com/watch?v=e9mT2Hrc-sg" >Video</a></p>
	
		<span class=title >Stuck on stage 2 but in the end skipped 2 stages | Classic Flower Snake</span>
		<p>-<a href="https://www.youtube.com/watch?v=yk4l24fq6g8" >Video</a></p>
	
		<span class=title >India vs. ZA on chess.com | gave a good fight before forfeit</span>
		<p>-<a href="https://www.youtube.com/watch?v=ysQFgJuyo_w" >Video</a></p>
	
		<span class=title >After skipping stage 2 and 5 I made it to the blue obstacle stage 6 | Classic Flower Snake</span>
		<p>-<a href="https://www.youtube.com/watch?v=VF_H9xse6FY" >Video</a></p>
	
		<span class=title >India vs. ZA on chess.com | 30 min of torture</span>
		<p>-<a href="https://www.youtube.com/watch?v=WpHd3HD9Jqw" >Video</a></p>
	
		<span class=title >Classic Flower Snake P5 | Reached Stage 5</span>
		<p>-<a href="https://www.youtube.com/watch?v=A1B95yFU2kc" >Video</a></p>
	
		<span class=title >India(rishi_788) vs. ZA on chess.com | quickly resigned</span>
		<p>-<a href="https://www.youtube.com/watch?v=-ByIx0s1Y7Y" >Video</a></p>
	
		<span class=title >classic flower snake p4 | reached stage 3</span>
		<p>-<a href="https://www.youtube.com/watch?v=ZXnXq9aiJ9A" >Video</a></p>
	
		<span class=title >Costa Rica(sheepwar29) vs. ZA on chess.com | quickly resigned</span>
		<p>-<a href="https://www.youtube.com/watch?v=R__rDDIDTDo" >Video</a></p>
	
		<span class=title >classic flower snake p3 | reached stage 4</span>
		<p>-<a href="https://www.youtube.com/watch?v=g1Si46GmvDs" >Video</a></p>
	
		<span class=title >Turkey vs. ZA on chess.com | total destruction</span>
		<p>-<a href="https://www.youtube.com/watch?v=SDxC5JlXvBc" >Video</a></p>
	
		<span class=title >Classic Snake Game Part 2 | Flying Cam Cast | Stuck On Stage 1</span>
		<p>-<a href="https://www.youtube.com/watch?v=HtqXE1LB9H8" >Video</a></p>
	
		<span class=title >India vs ZA on chess.com - Exploring Nature Challenge</span>
		<p>-<a href="https://www.youtube.com/watch?v=ZN_J6n9lpK4" >Video</a></p>
	
		<span class=title >South Africa vs. Japan on Chess.com - Dealing with Online Harassment 😞</span>
		<p>-<a href="https://www.youtube.com/watch?v=mxXAN9cQawA" >Video</a></p>
	
		<span class=title >Flower Snake Game - All The Way To Stage 3 - Challenge Prep</span>
		<p>-<a href=https://www.youtube.com/watch?v=RBlp_BwALH0 >Video</a></p>
	
		<span class=title >Why South African Forex Traders Need Quants</span>
		<p>Quantitative trading, or “quant” trading, is a sophisticated approach that involves using mathematical models and algorithms to analyze vast datasets and execute trading strategies. In the dynamic world of finance, these quant machines rely on a myriad of fundamental indicators to make buy and sell decisions.
		<a href=https://mngz636.medium.com/why-south-african-forex-traders-need-quants-d0cfb5f77fe6 >Article</a>-<a href=https://www.youtube.com/watch?v=xr09cilI-yI >Video</a>
		</p>
	
		<span class=title >A Skill Everyone Should Have (bank leverage), Get NYDF Funding.</span>
		<p>Understanding the intricacies of banking, loans, and financial planning is indeed crucial for navigating the complex landscape of personal and business finance.
		<a href=https://mngz636.medium.com/a-skill-everyone-should-have-bank-leverage-get-nydf-funding-85c3797c53a3 >Article</a>-<a href=https://www.youtube.com/watch?v=8Bl9YZW9Zfk >Video</a>
		</p>
	
		<span class=title >Specialized Software Using Framework and API of Established Businesses</span>
		<p>Why start from square one when you can ride the wave of success with the giants? Imagine this: instead of painstakingly building your own audience, leverage the colossal user base of industry titans to showcase your skills and skyrocket your success.
		<a href=https://mngz636.medium.com/specialized-software-using-framework-and-api-of-established-businesses-5620648545ab >Article</a>-<a href=https://www.youtube.com/watch?v=eZ6vpWpMlPI >Video</a>
		</p>
	
		<span class=title >I Stopped Doing My Homework To Focus On Girls At 6th Grade 😅</span>
		<p>It all began when the complexities of reading in English became a formidable obstacle in my academic path. Frustration and difficulty led me to make a radical decision — I stopped doing homework. It was a bold move, one that reflected a desire to redefine my priorities and focus on what I believed truly mattered.
		<a href=https://mngz636.medium.com/i-stopped-doing-my-homework-to-focus-on-girls-at-6th-grade-6048a1ca52f1 >Article</a>-<a href=https://www.youtube.com/watch?v=PX6iKC9FW7w >Video</a>
		</p>
	
		<span class=title >Creating A Travel Website With sites.google.com — In An Hour — For Free</span>
		<p>Unlock the power of cutting-edge web building features without breaking the bank! Say goodbye to the financial woes and coding setbacks with sites.google.com — your ticket to free, stable hosting that’s both sophisticated and reliable.
		<a href=https://mngz636.medium.com/creating-a-travel-website-with-sites-google-com-in-an-hour-for-free-97b5177a91c7 >Article</a>-<a href=https://www.youtube.com/watch?v=ztbU1NVRJYE >Video</a>
		</p>
	
		<span class=title >My First Github Repository (Black Box)</span>
		<p>In the wake of a disheartening experience where all my hard work was pilfered and erased, I made a resolute decision to take control of my code and embrace the collaborative power of GitHub. It was time to turn the page and navigate the world of version control, learning that sometimes, joining the ranks of collaborators is the key to safeguarding one’s creations. As the saying goes, “If you can’t beat them, join them.”
		<a href=https://mngz636.medium.com/my-first-github-repository-black-box-a50b4f93b6ab >Article</a>-<a href=https://www.youtube.com/watch?v=NHdD5ilUg1s >Video</a>
		</p>
	
		<span class=title >PHP Remote Text Writer/Editor Github Repository</span>
		<p>Now, here’s the deal: We’re not just building features; we’re crafting an experience. An experience that screams innovation, collaboration, and a touch of developer genius. We’re inviting you to be a part of this journey — to shape, enhance, and bring your unique skills to the table.
		<a href=https://mngz636.medium.com/php-remote-text-writer-editor-github-repository-9a7014362aa1 >Article</a>-<a href=https://www.youtube.com/watch?v=lcSJs95cEFM >Video</a>
		</p>
	
		<span class=title >Kasi Nametest — Testing Ten South African Girl Names</span>
		<p>“Kasi Namatest” sounds like an incredibly engaging and culturally resonant game! Drawing inspiration from the popular name tests on platforms like Facebook is a clever move, given the widespread interest people have in exploring aspects of their own identity.
		<a href=https://mngz636.medium.com/kasi-nametest-testing-ten-south-african-girl-names-b25c1ac92b92 >Article</a>-<a href=https://www.youtube.com/watch?v=B4RgQEuzcLY >Video</a>
		</p>
	
		<span class=title >F Snake Easy vs. Hard Mode</span>
		<p>In the midst of the challenging times brought about by Covid-19, I found myself unexpectedly without my employer. Before he passed away, his cryptic words lingered, “I can help you, only mom F can tell you the truth — it’s the snake.
		<a href=https://mngz636.medium.com/f-snake-easy-vs-hard-mode-d09ac064d4b0 >Article</a>-<a href=https://www.youtube.com/watch?v=dB3Bdr9t0FY >Video</a>
		</p>
	
		<span class=title >How to generate your CV in 3 minutes</span>
		<p>Embark on a hassle-free journey to create your professional CV in just three minutes — for free! Drawing from my experience at Philippi Brown’s Farm Internet Café, where I diligently crafted over 100 CVs, I’ve come to understand the crucial need for a service like this, especially for individuals stepping into the job market.
		<a href=https://mngz636.medium.com/how-to-generate-your-cv-in-3-minutes-b55e452f90ab >Article</a>-<a href=https://www.youtube.com/watch?v=57kS-89h9-E >Video</a>
		</p>	
		
		<span class=title >Introduction To Productlists</span>
		<p>Productlists is a tech firm working towards solutions to free the youth. Enjoy our instant game service, product listings and reviews.</p>	
		<span class=title >Kasi Nametest</span>
		<p>South African local instant game - enter your name and find out with Mzansi kasi you are from.</p>
		<span class=title >Recreational Activies In Newcastle South Africa</span>
		<p>Get the latest business and tourist information about Newcastle. Learn about Accommodation, Job Recruitment and more.</p>
		<span class=title >F-Snake Classic Productlists Game</span>
		<p>Play our classic snake game with seven stages. Overcome the obstacle and score as much points as you can.</p>
		<span class=title >F-Snake Classic Productlists Game</span>
		<p>Play our classic snake game. As you progress in the stages the obstacle moves faster and faster.</p>
		<span class=title >Touch Bistro Restaurant POS</span>
		<p>Replace your printed out food menu with a digital tablet menu able to send orders directly to kitchen without calling for waiter.</p>
		<span class=title >Touch Bistro Digital Menu and Payment</span>
		<p>Collect more information during payment so you can resell your specials to frequent customers.</p>
		<span class=title >CV Engine</span>
		<p>Generate Your CV For FREE in 3 minutes and send it to your email.</p>
		<span class=title >Stop Paying For Traffic.</span>
		<p>Saas and other large companies that need to pay for advertising on a monthly basis can create a content division in their businesses.</p>	
		<span class=title >Jungle Scout</span>
		<p>Use the best tools to sell on Amazon, optimize your listing - access best selling keywords and automatic repricing.</p>
		<span class=title >Adzooma</span>
		<p>Automate and manage all your Google, Facebook and Microsoft Ads in one place. Award winning App.</p>
		</div>
<iframe id=yt_tv width="100%" ></iframe>
<div class=row >
<div style="width:80%;float:left;" >
<a id=yt_title href=# onclick="nextVideo();return false;" class="block" style="background-repeat:no-repeat;background-size:50px auto;background-postion:0 0;padding-left:55px;display:block;width:100%;" ></a>
</div>
<div style="width:18%;float:left;" >
<a href=# onclick="nextVideo();return false;" class="block" style="width:100%;" >next video</a>
</div>
</div>
<div id=group_four_affiliate_video_dd style="padding:4px;font-size:1.3em;" >Productlists is a tech firm working towards solutions to free the youth. Enjoy our instant game service, product listings and reviews.</div>
		
		</div></div>
	<div style="float:right;color:white;" >
<a class=space href=https://www.instagram.com/productlists >Instagram</a>-<a class=space href=https://mngz47.github.io/mongeziSibongakonke/docs/ >Docs</a>-<a style="float:right" href="https://mngz47.github.io/pamel_slots/privacy_policy.html" >Privacy Policy</a>
	</div>
	
	</div>

	<script src=https://mngz47.github.io/monetize/monetize.js ></script>
	<script src="https://mngz47.github.io/monetize/video/api.js" ></script>
	<script src="https://mngz47.github.io/monetize/menu.js" ></script>


<link rel=stylesheet href=https://mngz47.github.io/monetize/style.css />
<link rel=stylesheet href=https://mngz47.github.io/monetize/bootstrap.min.css />

</div> 
   <script>
      toggle(e("start"));
   </script>
</body>
</html>
